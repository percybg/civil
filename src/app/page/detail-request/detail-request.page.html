<ion-header >
  <ion-toolbar lines="none">
    <ion-icon src="../../assets/icon/arrow.svg" class="ion-padding"slot="start" (click)="dismiss()"></ion-icon>
    <ion-title class="ion-text-center">
      Detalhe Requisição
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <app-spinner [showSpinner]="!load" *ngIf="!load"></app-spinner>
  <form id="requestForm"  [@hideShowAnimator]="load" style="height: 100%;">

    <ion-row class="ion-justify-content-center corpo" *ngIf="load && !error">
      <ion-col size=11>
        <div class="statusDiv">
          <p>STATUS: <span>{{reqItem.statusDescricao}}</span></p>
        </div>
      </ion-col>
      <ion-col size="11">
        <ion-item class="desc" style="margin-top: 0!important;">
          Requisição
        </ion-item>
        <ion-card>
          <ion-card-header>
          </ion-card-header>
          <ion-card-content>
            <ion-col size="12" style="padding: 0;">
            <ion-row class="borded">
              <ion-col size="6">
                <ion-item lines="none">
                  <ion-label position="stacked"  class="labelTitle">Nº Requisição</ion-label>
                  <p>{{reqItem.codigo}}</p>
                </ion-item>
              </ion-col>
              <ion-col  size="6">
                <ion-item lines="none">
                  <ion-label position="stacked"  class="labelTitle">Data:</ion-label>
                  <p>{{reqItem.dataHora}}</p>
                </ion-item>
              </ion-col>
            </ion-row>
            <ion-row class="ion-no-padding">
              <ion-col size="12">
                <ion-item  lines="none">
                  <ion-label position="stacked"  class="labelTitle">Empreendimento:</ion-label>
                  <p>{{reqItem.empreendimento.descricao || 'Não cadastrado'}}</p>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-col>
          </ion-card-content>
        </ion-card>
      </ion-col>
      <ion-col  size="11">
        <ion-item class="desc">
          Insumos
        </ion-item>
        <ion-card *ngFor="let item of reqItem.itens">
          <ion-card-header>
          </ion-card-header>
          <ion-card-content>
            <ion-col size="12" style="padding: 0;">
            <ion-row class="borded">
              <ion-col size="12">
                <ion-item lines="none">
                  <ion-label position="stacked"  class="labelTitle">Insumo:</ion-label>
                  <p>{{item.insumo.descricao}}</p>
                </ion-item>
              </ion-col>

            </ion-row>
            <ion-row class="ion-no-padding">
              <ion-col size="6">
                <ion-item  lines="none">
                  <ion-label position="stacked"  class="labelTitle">Quantidade:</ion-label>
                  <p>{{!!item.quantidade ? item.quantidade : null}}</p>
                </ion-item>
              </ion-col>
              <ion-col  size="6">
                <ion-item lines="none">
                  <ion-label position="stacked"  class="labelTitle">Unidade:</ion-label>
                  <p>{{item.insumo.unidade}}</p>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-col>
          </ion-card-content>
        </ion-card>
        <ion-row  class="ion-justify-content-center" *ngIf="!!reqItem.itens && reqItem.itens.length === 0" >
          <ion-col size="5" class="ion-margin-top" >
            <div class="imgDiv" >
              <ion-img src="../../assets/img/noInsumos.svg"></ion-img>
            </div>
          </ion-col>
          <ion-col size="11">
            <h2 class="titleNoInsumos">Nenhum insumo
              adicionado nesta requisição.</h2>
          </ion-col>
        </ion-row>
      </ion-col>
      <ion-col size="11">
        <ion-item class="desc">
          Demais informações
        </ion-item>
        <ion-card>
          <ion-card-header>
          </ion-card-header>
          <ion-card-content>
            <ion-col size="12" style="padding: 0;">
            <ion-row class="borded">
              <ion-col size="12">
                <ion-item lines="none">
                  <ion-label position="stacked"  class="labelTitle">Solicitante:</ion-label>
                  <p>{{reqItem.codigo}}</p>
                </ion-item>
              </ion-col>
            </ion-row>
            <ion-row class="borded">
              <ion-col size="12">
                <ion-item  lines="none">
                  <ion-label position="stacked"  class="labelTitle">Numero OF:</ion-label>
                  <p>{{!!reqItem.ofCodigo ? reqItem.ofCodigo : 'Não possue Numero OF'}}</p>
                </ion-item>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col size="12">
                <ion-item  lines="none">
                  <ion-label position="stacked"  class="labelTitle">Aprovador:</ion-label>
                  <p>{{!!reqItem.aprovadoPorUsuario ? reqItem.aprovadoPorUsuario : 'Aprovação pendente'}}</p>
                </ion-item>
              </ion-col>
            </ion-row>
          </ion-col>
          </ion-card-content>
        </ion-card>
      </ion-col>
      <ion-col size="11" *ngIf="reqItem.observacao">
        <ion-item class="desc">
          Observações:
        </ion-item>
        <ion-item lines="none">
          <ion-textarea placeholder="" [value]="reqItem.observacao" cols="20"></ion-textarea>
        </ion-item>
      </ion-col>
      <ion-col size="11">
        <ion-row class="ion-justify-content-center">
          <ion-col size="10">
            <ion-button class="btnRedondo btnVoltar" (click)="dismiss()"  expand="block"><ion-ripple-effect type="unbounded"></ion-ripple-effect>Voltar</ion-button>
          </ion-col>
          <ion-col size="10">
            <ion-button class="btnRedondo btnVoltar" (click)="editReq()"  expand="block" [disabled]="loadButton">
              <ion-ripple-effect type="unbounded"></ion-ripple-effect>
              <ion-spinner name="crescent" *ngIf="loadButton"></ion-spinner>
              {{!loadButton ? 'EDITAR REQUISIÇÃO' :'' }}
            </ion-button>
          </ion-col>
        </ion-row>
      </ion-col>
    </ion-row>
    <ion-row  class="ion-justify-content-center" *ngIf="load && error" style="height: 100%; align-items: center;">
      <ion-col size="5" class="ion-margin-top" >
        <div class="imgDiv" >
          <ion-img src="../../assets/img/noInsumos.svg"></ion-img>

        </div>
        <h2 class="titleNoInsumos">Algo deu errado</h2>
      </ion-col>

    </ion-row>
  </form>
</ion-content>
